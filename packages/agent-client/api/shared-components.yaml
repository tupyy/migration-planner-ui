# Generated from: Migration Planner Agent UI API - Shared Components
# Commit: e12120720e22a0a537aeb107b0db2875bcb3b105
#
# This companion OpenAPI specification file contains all the schema definitions
# that are referenced externally in openapi.yaml. These schemas are extracted
# from the main openapi.yaml file (https://github.com/kubev2v/migration-planner/blob/main/api/v1alpha1/openapi.yaml?raw=true) and are required
# for the Inventory schema used by the /api/v1/inventory endpoint.
#
# To use this file, merge it with openapi.yaml or reference it using
# OpenAPI's external reference mechanism.
#
openapi: 3.0.1
info:
  title: Migration Planner Agent UI API - Shared components
  version: undefined
  description: Schema definitions referenced by openapi.yaml
  license:
    name: Apache 2.0
    url: https://www.apache.org/licenses/LICENSE-2.0.html

components:
  schemas:
    Inventory:
      type: object
      required:
        - vcenter_id
        - clusters
      properties:
        vcenter_id:
          type: string
          description: ID of the vCenter
        clusters:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/InventoryData'
          description: Map of cluster names to their inventory data
        vcenter:
          $ref: '#/components/schemas/InventoryData'
          description: vCenter-level inventory data

    InventoryData:
      type: object
      required:
        - vms
        - infra
      properties:
        vcenter:
          deprecated: true
          nullable: true
          $ref: '#/components/schemas/VCenter'
        vms:
          $ref: '#/components/schemas/VMs'
        infra:
          $ref: '#/components/schemas/Infra'

    VCenter:
      type: object
      required:
        - id
      properties:
        id:
          type: string

    VMs:
      type: object
      required:
        - total
        - totalMigratable
        - cpuCores
        - ramGB
        - diskGB
        - diskCount
        - powerStates
        - notMigratableReasons
        - migrationWarnings
      properties:
        total:
          type: integer
        totalMigratable:
          type: integer
        totalMigratableWithWarnings:
          type: integer
        cpuCores:
          $ref: '#/components/schemas/VMResourceBreakdown'
        diskSizeTier:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/diskSizeTierSummary'
        diskTypes:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/diskTypeSummary'
        distributionByCpuTier:
          type: object
          description: Distribution of VMs across CPU tier buckets (e.g., "0-4", "5-8", "9-16", "17-32", "32+")
          additionalProperties:
            type: integer
        distributionByMemoryTier:
          type: object
          description: Distribution of VMs across Memory tier buckets (e.g., "0-4", "5-16", "17-32", "33-64", "65-128", "129-256", "256+")
          additionalProperties:
            type: integer
        ramGB:
          $ref: '#/components/schemas/VMResourceBreakdown'
        diskGB:
          $ref: '#/components/schemas/VMResourceBreakdown'
        diskCount:
          $ref: '#/components/schemas/VMResourceBreakdown'
        nicCount:
          $ref: '#/components/schemas/VMResourceBreakdown'
          nullable: false
          x-oapi-codegen-extra-tags:
            json: "nicCount,omitempty"
        powerStates:
          type: object
          additionalProperties:
            type: integer
        os:
          deprecated: true
          type: object
          additionalProperties:
            type: integer
        osInfo:
          type: object
          additionalProperties:
            $ref: '#/components/schemas/osInfo'
        notMigratableReasons:
          type: array
          items:
            $ref: '#/components/schemas/MigrationIssue'
        migrationWarnings:
          type: array
          items:
            $ref: '#/components/schemas/MigrationIssue'

    diskSizeTierSummary:
      type: object
      required:
        - totalSizeTB
        - vmCount
      properties:
        totalSizeTB:
          type: number
          format: double
          description: Total disk size in TB for this tier
        vmCount:
          type: integer
          description: Number of VMs in this tier

    diskTypeSummary:
      type: object
      required:
        - vmCount
        - totalSizeTB
      properties:
        vmCount:
          type: integer
          description: Number of VMs that have at least one disk of this type
        totalSizeTB:
          type: number
          format: double
          description: Total disk size in TB for this disk type

    osInfo:
      type: object
      required:
        - count
        - supported
      properties:
        count:
          type: integer
        supported:
          type: boolean
        upgradeRecommendation:
          type: string
          description: Recommended OS upgrade for MTV unsupported OS that can be upgraded to a supported OS

    Infra:
      type: object
      required:
        - totalHosts
        - hostPowerStates
        - networks
        - datastores
      properties:
        totalHosts:
          type: integer
        totalDatacenters:
          type: integer
        totalClusters:
          type: integer
          deprecated: true
        clustersPerDatacenter:
          type: array
          items:
            type: integer
        cpuOverCommitment:
          type: number
          format: double
          description: CPU Overcommitment Ratio. Calculated as total Allocated vCPUs / Total Physical Cores
        memoryOverCommitment:
          type: number
          format: double
          description: RAM memory Overcommitment Ratio. Calculated as total Allocated memory / Total memory available
        hosts:
          type: array
          items:
            $ref: '#/components/schemas/Host'
        hostsPerCluster:
          type: array
          items:
            type: integer
          deprecated: true
        vmsPerCluster:
          type: array
          items:
            type: integer
          deprecated: true
        hostPowerStates:
          type: object
          additionalProperties:
            type: integer
        networks:
          type: array
          items:
            $ref: '#/components/schemas/Network'
        datastores:
          type: array
          items:
            $ref: '#/components/schemas/Datastore'

    Host:
      type: object
      required:
        - vendor
        - model
      properties:
        id:
          type: string
          description: Unique identifier for this host
        vendor:
          type: string
        model:
          type: string
        cpuCores:
          type: integer
          description: Number of CPU cores
          nullable: true
        cpuSockets:
          type: integer
          description: Number of CPU sockets
          nullable: true
        memoryMB:
          type: integer
          format: int64
          description: Host memory in MB
          nullable: true

    Network:
      type: object
      required:
        - type
        - name
      properties:
        type:
          type: string
          enum: [ standard, distributed, dvswitch, unsupported ]
        name:
          type: string
        vlanId:
          type: string
        dvswitch:
          type: string
        vmsCount:
          type: integer

    Datastore:
      type: object
      required:
        - type
        - totalCapacityGB
        - freeCapacityGB
        - vendor
        - diskId
        - hardwareAcceleratedMove
        - protocolType
        - model
      properties:
        type:
          type: string
        totalCapacityGB:
          type: integer
        freeCapacityGB:
          type: integer
        vendor:
          type: string
        diskId:
          type: string
        hardwareAcceleratedMove:
          type: boolean
        protocolType:
          type: string
        model:
          type: string
        hostId:
          type: string
          description: Identifier of the host where this datastore is attached
          nullable: true

    VMResourceBreakdown:
      type: object
      required:
        - total
        - totalForMigratable
        - totalForMigratableWithWarnings
        - totalForNotMigratable
      properties:
        total:
          type: integer
        totalForMigratable:
          type: integer
        totalForMigratableWithWarnings:
          type: integer
        totalForNotMigratable:
          type: integer
        histogram:
          deprecated: true
          $ref: '#/components/schemas/Histogram'

    Histogram:
      type: object
      deprecated: true
      required:
        - minValue
        - step
        - data
      properties:
        minValue:
          type: integer
        step:
          type: integer
        data:
          type: array
          items:
            type: integer

    MigrationIssue:
      type: object
      required:
        - label
        - assessment
        - count
      properties:
        id:
          type: string
        label:
          type: string
        assessment:
          type: string
        count:
          type: integer

